with cum_weight_data as(
    select turn, person_name, 
    sum(weight) over (order by turn asc) as cum_weight
    from Queue
    group by 1
)

select person_name
from cum_weight_data
where cum_weight <=1000
order by cum_weight desc
limit 1


